# Freelancer Earnings NLP CLI

A command-line tool for analyzing freelancer earnings using natural language queries, powered by GPT-4o and SQL.

## Features

- Loads freelancer data from a CSV into an SQLite database
- Uses Langchain + GPT-4o to convert natural language questions into SQL
- Displays query results directly in the terminal
- Dependency injection using `punq`
- Async support using `asyncio`, `SQLAlchemy`, and `aiosqlite`

## Predefined Questions

- What is the average earnings per region?
- Which region has the most expert freelancers?
- How many freelancers completed more than 100 projects?
- What is the average earnings difference between crypto and non-crypto payments?
- What is the distribution of earnings by freelancer category?
- Which payment method is used most by expert freelancers?
- Which region has the highest number of novice freelancers?
- What is the average number of projects completed by freelancers using PayPal?
- What is the median earnings of freelancers in Europe?
- How many freelancers earn more than $10,000 USD?

## Setup

1. Install [Poetry](https://python-poetry.org/docs/).
2. Clone the repository and navigate into it.
3. Run `poetry install` to install dependencies.
4. Make sure your environment contains `OPENAI_API_KEY`
5. Run with: `poetry run python src/freelancer_app/cli_async.py`

## Technologies Used

- **Langchain** + **OpenAI GPT-4o** for SQL generation
- **SQLAlchemy** (async) and **aiosqlite** for database interaction
- **Pandas** for loading CSV data in chunks
- **Punq** for dependency injection

## Evaluation Report

### Approach

We implemented an AI-powered CLI assistant that:
- loads structured data from a CSV file into an SQLite database
- extracts table schema at runtime
- sends a prompt with schema and a user question to an LLM
- executes the generated SQL and displays the result

### Effectiveness and Accuracy

- GPT-4o with Langchain's `ChatOpenAI` produces highly accurate SQL when prompted with detailed schema.
- SQL queries returned were executable with SQLite without post-processing once markdown formatting was suppressed.
- The system handled incorrect input gracefully during schema extraction and loading.

### Technologies Evaluation

**Worked well:**
- Langchain for prompt formatting and message passing
- Pandas + SQLAlchemy integration for data loading
- Async architecture using `asyncio`, `aiosqlite`, `sqlalchemy.ext.asyncio`
- Punq for clean and scalable service wiring

**What didn’t work or was avoided:**
- Loading the entire CSV into memory at once — we used chunked inserts
- Relying on full dataset serialization into LLM prompt — schema-only approach worked better and complied with restrictions

### Quality Criteria

- **Correctness**: SQL generated by the LLM is valid and answers the question
- **Robustness**: Handles missing schema or broken database cleanly
- **Extensibility**: Core services are decoupled and injectable
- **LLM Compatibility**: Compatible with other Langchain-compatible chat models (Claude, Gemini, etc.)